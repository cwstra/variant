/*! For license information please see 526f20c4.ea881ace.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{171:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return O})),n.d(t,"metadata",(function(){return v})),n.d(t,"rightToc",(function(){return j})),n.d(t,"default",(function(){return N}));var a=n(1),r=n(9),i=n(0),o=n.n(i),c=n(176),s=(n(29),n(19),n(20),n(186));var l=function(){return Object(i.useContext)(s.a)},p=n(178),b=n.n(p),u=n(153),m=n.n(u),d=37,h=39;var f=function(e){var t=e.block,n=e.children,a=e.defaultValue,r=e.values,c=e.groupId,s=l(),p=s.tabGroupChoices,u=s.setTabGroupChoices,f=Object(i.useState)(a),y=f[0],O=f[1];if(null!=c){var v=p[c];null!=v&&v!==y&&O(v)}var j=function(e){O(e),null!=c&&u(c,e)},g=[];return o.a.createElement("div",null,o.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:b()("tabs",{"tabs--block":t})},r.map((function(e){var t=e.value,n=e.label;return o.a.createElement("li",{role:"tab",tabIndex:"0","aria-selected":y===t,className:b()("tab-item",m.a.tabItem,{"tab-item--active":y===t}),key:t,ref:function(e){return g.push(e)},onKeyDown:function(e){return function(e,t,n){switch(n.keyCode){case h:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case d:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(g,e.target,e)},onFocus:function(){return j(t)},onClick:function(){return j(t)}},n)}))),o.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},i.Children.toArray(n).filter((function(e){return e.props.value===y}))[0]))};var y=function(e){return o.a.createElement("div",null,e.children)},O={id:"motivation",title:"Motivation"},v={id:"motivation",title:"Motivation",description:"> \u26a0 This page explains why variant matters. If you just want to know how to use the library, [move on](use/variant) and come back to this page.",source:"@site/docs\\motivation.mdx",permalink:"/variant/docs/motivation",sidebar:"someSidebar",previous:{title:"Introduction",permalink:"/variant/docs/intro"},next:{title:"Variant",permalink:"/variant/docs/use/variant"}},j=[{value:"Discriminated Unions",id:"discriminated-unions",children:[{value:"Discriminated Unions <em>in TypeScript</em>",id:"discriminated-unions-in-typescript",children:[]},{value:"\ud83d\udea7 TODO",id:"-todo",children:[]}]}],g={rightToc:j};function N(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},g,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"\u26a0 This page explains why variant matters. If you just want to know how to use the library, ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"use/variant"}),"move on")," and come back to this page.")),Object(c.b)("h2",{id:"discriminated-unions"},"Discriminated Unions"),Object(c.b)("p",null,"This library is all about variant types a.k.a. discriminated unions. Better writers than I have covered what makes them special. I recommend this link if they are new to you:"),Object(c.b)("p",null,Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"http://reasonmlhub.com/exploring-reasonml/ch_variants.html"}),Object(c.b)("strong",{parentName:"a"},"Variant Types")," (",Object(c.b)("em",{parentName:"a"},"ReasonML Hub"),")")),Object(c.b)("blockquote",null,Object(c.b)("h3",Object(a.a)({parentName:"blockquote"},{id:"note"}),"Note:"),Object(c.b)("p",{parentName:"blockquote"},"Technically speaking, this implementation most resembles ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"http://reasonmlhub.com/exploring-reasonml/ch_polymorphic-variants.html"}),Object(c.b)("strong",{parentName:"a"},"polymorphic variants")),". The implications of this will become clearer in the ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"use/grouping"}),"grouping")," section. Users familiar with functional programming may be stroking neckbeards in consideration at this point.")),Object(c.b)("p",null,"The short version is this: A variant type is like an enum but each case can hold some extra data. Enums already help us express ideas in the domain as a set of symbols. Variants allow those symbols to include more specific information depending on each case. "),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"This approach is a natural fit for describing a protocol where each message is a tag and the overall lexicon forms the variant type. A ",Object(c.b)("em",{parentName:"li"},"message handler")," is a single ",Object(c.b)("a",Object(a.a)({parentName:"li"},{href:"/variant/docs/api#match"}),Object(c.b)("inlineCode",{parentName:"a"},"match()"))," statement. ",Object(c.b)("ul",{parentName:"li"},Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(a.a)({parentName:"li"},{href:"use/redux"}),"\ud83d\udc4b Hey there, redux")," ."))),Object(c.b)("li",{parentName:"ul"},"Typically it's difficult to analyze code blocks. By holding to a pattern of matching against a variant (a.k.a. ",Object(c.b)("em",{parentName:"li"},"a set number of options"),") the compiler can help check your code flow for completeness, or ",Object(c.b)("em",{parentName:"li"},"exhaustiveness"),"."),Object(c.b)("li",{parentName:"ul"},"An underappreciated benefit is their ability to withstand refactoring. As an application grows in complexity a variant can simply add a new tag when branching functionality is needed. As a workflow needs more context the tag representing it can evolve from a simple symbol to a more complex type with its own constructor logic or async processing.")),Object(c.b)("h3",{id:"discriminated-unions-in-typescript"},"Discriminated Unions ",Object(c.b)("em",{parentName:"h3"},"in TypeScript")),Object(c.b)("p",null,"TypeScript has an inherent problem. Interfaces and inferred types only exist at compile time, but inspecting a type can only be done at runtime. That makes it difficult to simultaneously benefit from types and make decisions based on those types. Classes are one solution to provide compile time type checking and runtime behavior together but they don't ",Object(c.b)("em",{parentName:"p"},"serialize"),", so we can't send them over the network or shove them in a redux store. Enter variant types, and this library."),Object(c.b)("p",null,"This can certainly be done with raw discriminated unions, but this is what it looks like at its best. Compare this vanilla TypeScript code to the animal example with variant."),Object(c.b)(f,{groupId:"motivation-code-sample",defaultValue:"vanilla",values:[{value:"vanilla",label:"Vanilla TS"},{value:"variant",label:"Variant"}],mdxType:"Tabs"},Object(c.b)(y,{value:"vanilla",mdxType:"TabItem"},Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript"}),"const DOG_TYPE = 'dog';\nconst CAT_TYPE = 'cat';\nconst SNAKE_TYPE = 'snake';\n\nfunction dog(name: string, favoriteBall?: string) {\n    return {\n        type: DOG_TYPE as typeof DOG_TYPE,\n        name,\n        favoriteBall,\n    }\n}\nconst cat = (name: string, daysSinceDamage: number) => ({\n    type: CAT_TYPE as typeof CAT_TYPE,\n    name,\n    daysSinceDamage,\n})\nconst snake = (name: string, patternName?: string) => ({\n    type: SNAKE_TYPE as typeof SNAKE_TYPE,\n    name,\n    pattern: patternName ?? 'striped',\n})\n\ntype Animal = \n    | ReturnType<typeof dog>\n    | ReturnType<typeof cat>\n    | ReturnType<typeof snake>;\n;\n"))),Object(c.b)(y,{value:"variant",mdxType:"TabItem"},Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript"}),"import variant, {variantList, VariantOf, fields, TypeNames} from 'variant';\n\nconst Animal = variantList([\n    variant('dog', fields<{name: string, favoriteBall?: string}>()),\n    variant('cat', fields<{name: string, daysSinceDamage: number}>()),\n    variant('snake', (name: string, patternName?: string) => ({\n        name,\n        pattern: patternName ?? 'striped',\n    })),\n]);\ntype Animal<T extends TypeNames<typeof Animal> = undefined> = VariantOf<typeof Animal, T>;\n")))),Object(c.b)("hr",null),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"Both methods result in the following union type:")),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript"}),'type Animal = {\n    type: "dog";\n    name: string;\n    favoriteBall?: string | undefined;\n} | {\n    type: "cat";\n    name: string;\n    daysSinceDamage: number;\n} | {\n    type: "snake";\n    name: string;\n    pattern: string;\n}\n')),Object(c.b)("p",null,"But the variant approach is shorter, has better types, ",Object(c.b)("em",{parentName:"p"},"automatically updates")," as I add new animals, and requires ",Object(c.b)("strong",{parentName:"p"},"no manual casting"),"."),Object(c.b)("hr",null),Object(c.b)("h3",{id:"-todo"},"\ud83d\udea7 TODO"),Object(c.b)("p",null,"(pardon our dust)"),Object(c.b)("ul",{className:"contains-task-list"},Object(c.b)("li",Object(a.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(a.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Add section on exhaustiveness"),Object(c.b)("li",Object(a.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(a.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","Add section on extra features variant gives you that aren't in TS by default.",Object(c.b)("ul",Object(a.a)({parentName:"li"},{className:"contains-task-list"}),Object(c.b)("li",Object(a.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(a.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ",'subsection "Matrix and Flags"'),Object(c.b)("li",Object(a.a)({parentName:"ul"},{className:"task-list-item"}),Object(c.b)("input",Object(a.a)({parentName:"li"},{type:"checkbox",checked:!1,disabled:!0}))," ","fluent utilities to process DUs (match, matchElse, partialLookup, etc.)")))))}N.isMDXComponent=!0},176:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),p=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},b=function(e){var t=p(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),b=p(n),m=a,d=b["".concat(o,".").concat(m)]||b[m]||u[m]||i;return n?r.a.createElement(d,c({ref:t},l,{components:n})):r.a.createElement(d,c({ref:t},l))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=m;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var l=2;l<i;l++)o[l]=n[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},178:function(e,t,n){var a;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var i=typeof a;if("string"===i||"number"===i)e.push(a);else if(Array.isArray(a)&&a.length){var o=r.apply(null,a);o&&e.push(o)}else if("object"===i)for(var c in a)n.call(a,c)&&a[c]&&e.push(c)}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(a=function(){return r}.apply(t,[]))||(e.exports=a)}()},186:function(e,t,n){"use strict";var a=n(0),r=Object(a.createContext)({tabGroupChoices:{},setTabGroupChoices:function(){}});t.a=r}}]);