(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{170:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return c})),a.d(t,"default",(function(){return s}));var n=a(1),i=a(9),r=(a(0),a(179)),o={id:"variant",title:"Variant"},l={id:"use/variant",title:"Variant",description:"A **variant** is a single object that can take many forms. Each of those forms has a *type*, sometimes called a *tag*, and optionally a *body* that tells us what kind of data we have available if in that form. In the introduction we saw how several types of animals could be grouped into the *module* `Animal`.\r",source:"@site/docs\\use\\variant.md",permalink:"/variant/docs/use/variant",sidebar:"someSidebar",previous:{title:"Motivation",permalink:"/variant/docs/motivation"},next:{title:"Grouping",permalink:"/variant/docs/use/grouping"}},c=[{value:"<code>variant()</code>",id:"variant",children:[]},{value:"<code>payload()</code>",id:"payload",children:[]},{value:"<code>fields()</code>",id:"fields",children:[]},{value:"Checking for a specific type",id:"checking-for-a-specific-type",children:[]},{value:"Conclusion",id:"conclusion",children:[]}],p={rightToc:c};function s(e){var t=e.components,a=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},p,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"A ",Object(r.b)("strong",{parentName:"p"},"variant")," is a single object that can take many forms. Each of those forms has a ",Object(r.b)("em",{parentName:"p"},"type"),", sometimes called a ",Object(r.b)("em",{parentName:"p"},"tag"),", and optionally a ",Object(r.b)("em",{parentName:"p"},"body")," that tells us what kind of data we have available if in that form. In the introduction we saw how several types of animals could be grouped into the ",Object(r.b)("em",{parentName:"p"},"module")," ",Object(r.b)("inlineCode",{parentName:"p"},"Animal"),"."),Object(r.b)("p",null,"At this point we can express the data, but I'd like the ability to interact with our virtual menagerie. Let's create our first ",Object(r.b)("em",{parentName:"p"},"action")," or command, ",Object(r.b)("inlineCode",{parentName:"p"},"AddAnimal"),"."),Object(r.b)("h3",{id:"variant"},Object(r.b)("inlineCode",{parentName:"h3"},"variant()")),Object(r.b)("p",null,"Calling ",Object(r.b)("inlineCode",{parentName:"p"},"variant()")," with the name of a type returns a ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://en.wikipedia.org/wiki/Algebraic_data_type#Explanation"}),Object(r.b)("em",{parentName:"a"},"tag constructor"))," (a.k.a. ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://redux.js.org/basics/actions"}),Object(r.b)("em",{parentName:"a"},"action creator")),") for that type."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript",metastring:"{3}","{3}":!0}),"import variant from 'variant';\n\nconst addAnimal = variant('AddAnimal');\n\nconst action = addAnimal(); \n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"result:")," ",Object(r.b)("inlineCode",{parentName:"p"},"typeof action: { type: 'AddAnimal' }")),Object(r.b)("p",null,"To add additional properties, provide a function as a second parameter. The arguments of this function will become the arguments of the tag constructor, and the properties in the returned object will become the properties of that form of the variant. The ",Object(r.b)("inlineCode",{parentName:"p"},"type: ...")," property will be merged in for you. "),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript",metastring:"{4}","{4}":!0}),"import variant from 'variant';\nimport {Animal} from '...';\n\nconst addAnimal = variant('AddAnimal', (animal: Animal) => ({animal}));\n\nconst action = addAnimal(Animal.dog({name: 'Cerberus'})); \nconsole.log(action); \n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"result:")," ",Object(r.b)("inlineCode",{parentName:"p"},"typeof action: { type: 'AddAnimal', animal: Animal }")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"prints:")," ",Object(r.b)("inlineCode",{parentName:"p"},"{ type: 'AddAnimal', animal: { type: 'dog', name: 'Cerberus' }}")),Object(r.b)("h3",{id:"payload"},Object(r.b)("inlineCode",{parentName:"h3"},"payload()")),Object(r.b)("p",null,"Taking a single variable and storing it as data like this is a ",Object(r.b)("em",{parentName:"p"},"very")," common pattern. The ",Object(r.b)("inlineCode",{parentName:"p"},"payload()")," helper function is here to make that even simpler."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript"}),"const addAnimal = variant('AddAnimal', payload<Animal>());\n")),Object(r.b)("p",null,"The downside of ",Object(r.b)("inlineCode",{parentName:"p"},"payload()")," is that it only takes one element, and it will always be called ",Object(r.b)("inlineCode",{parentName:"p"},"'payload'"),". In the case of ",Object(r.b)("inlineCode",{parentName:"p"},"addAnimal")," this is fine. It's clear from context that the payload of the 'AddAnimal' command is the animal to be added. However, if we need to use a name for the field or use multiple fields then it's time for the next helper function. "),Object(r.b)("h3",{id:"fields"},Object(r.b)("inlineCode",{parentName:"h3"},"fields()")),Object(r.b)("p",null,"We saw ",Object(r.b)("inlineCode",{parentName:"p"},"fields")," already in our quick start example. Here's that again for reference. "),Object(r.b)("blockquote",null,Object(r.b)("pre",{parentName:"blockquote"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript",metastring:"{2-3}","{2-3}":!0}),"export const Animal = variantModule({\n    dog: fields<{name: string, favoriteBall?: string}>(),\n    cat: fields<{name: string, furnitureDamaged: number}>(),\n    snake: (name: string, pattern = 'striped') => ({name, pattern}),\n});\n"))),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"fields()")," is expecting an object type as its generic parameter. That object type describes the body of the variant, minus the 'type' property which the library will fill in. "),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript",metastring:"{3}","{3}":!0}),"import variant, {fields} from 'variant';\n\nconst addAnimal = variant('AddAnimal', fields<{animal: Animal}>());\n\nconst action = addAnimal({animal: Animal.dog({name: 'Lily'})}); \nconsole.log(action);\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"result:")," ",Object(r.b)("inlineCode",{parentName:"p"},"typeof action: { type: 'AddAnimal', animal: Animal }")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"prints:")," ",Object(r.b)("inlineCode",{parentName:"p"},"{ type: 'AddAnimal', animal: { type: 'dog', name: 'Lily' }}")),Object(r.b)("h2",{id:"checking-for-a-specific-type"},"Checking for a specific type"),Object(r.b)("p",null,"You may have some wild ",Object(r.b)("inlineCode",{parentName:"p"},"animal: Animal")," and want to check specifically if you've got a ",Object(r.b)("inlineCode",{parentName:"p"},"snake")," in your midst."),Object(r.b)("p",null,"To do so, use the ",Object(r.b)("inlineCode",{parentName:"p"},"isType")," function."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript"}),"if (isType(animal, 'snake')) {\n    console.log('Found a snake with', animal.pattern, 'skin.');\n}\n")),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"isType")," is a user-defined type guard, so TypeScript will narrow the type of the variable you pass in. The second parameter, the string literal (",Object(r.b)("inlineCode",{parentName:"p"},"'snake'"),") will be restricted to only valid ",Object(r.b)("inlineCode",{parentName:"p"},"type"),"s of the variant. However, it is also possible to call ",Object(r.b)("inlineCode",{parentName:"p"},"isType")," with the constructor itself, which some users may find more ergonomic."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-ts"}),"if (isType(animal, Animal.snake)) {\n    console.log('Found a snake with', animal.pattern, 'skin.');\n}\n")),Object(r.b)("hr",null),Object(r.b)("h2",{id:"conclusion"},"Conclusion"),Object(r.b)("p",null,"When choosing between the approaches to defining a variant, I recommend this process:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"If there is only one item to pass, and its purpose is clear from context, consider using ",Object(r.b)("inlineCode",{parentName:"li"},"payload()"),"."),Object(r.b)("li",{parentName:"ol"},"If there are multiple fields or a named property is preferred, use ",Object(r.b)("inlineCode",{parentName:"li"},"fields()"),"."),Object(r.b)("li",{parentName:"ol"},"If more control is desired (default elements or logging, for example) use a function.")))}s.isMDXComponent=!0},179:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return u}));var n=a(0),i=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var p=i.a.createContext({}),s=function(e){var t=i.a.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l({},t,{},e)),a},b=function(e){var t=s(e.components);return i.a.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},d=Object(n.forwardRef)((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,o=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),b=s(a),d=n,u=b["".concat(o,".").concat(d)]||b[d]||m[d]||r;return a?i.a.createElement(u,l({ref:t},p,{components:a})):i.a.createElement(u,l({ref:t},p))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,o=new Array(r);o[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var p=2;p<r;p++)o[p]=a[p];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"}}]);