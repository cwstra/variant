/*! For license information please see 73608223.2214750e.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{158:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return p})),n.d(t,"default",(function(){return m}));var a=n(1),r=n(9),i=(n(0),n(179)),o=n(194),c=n(193),s={id:"motivation",title:"Motivation"},l={id:"motivation",title:"Motivation",description:"> \u26a0 This page explains why variant matters. If you just want to know how to use the library, [move on](use/variant) and come back to this page.\r",source:"@site/docs\\motivation.md",permalink:"/variant/docs/motivation",sidebar:"someSidebar",previous:{title:"Introduction",permalink:"/variant/docs/intro"},next:{title:"Variant",permalink:"/variant/docs/use/variant"}},p=[{value:"Discriminated Unions",id:"discriminated-unions",children:[{value:"Discriminated Unions <em>in TypeScript</em>",id:"discriminated-unions-in-typescript",children:[]}]}],u={rightToc:p};function m(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"\u26a0 This page explains why variant matters. If you just want to know how to use the library, ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"use/variant"}),"move on")," and come back to this page.")),Object(i.b)("p",null,"TypeScript has an inherent problem. Interfaces and inferred types only exist at compile time, but inspecting a type can only be done at runtime. That makes it difficult to simultaneously benefit from types and make decisions based on those types. Classes are one solution to provide compile time type checking and runtime behavior together but they don't ",Object(i.b)("em",{parentName:"p"},"serialize"),", so we can't send them over the network or shove them in a redux store. Enter variant types, and this library."),Object(i.b)("h2",{id:"discriminated-unions"},"Discriminated Unions"),Object(i.b)("p",null,"This library is all about variant types a.k.a. discriminated unions. I recommend this link if they are new to you:"),Object(i.b)("p",null,Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"http://reasonmlhub.com/exploring-reasonml/ch_variants.html"}),Object(i.b)("strong",{parentName:"a"},"Variant Types")," (",Object(i.b)("em",{parentName:"a"},"ReasonML Hub"),")")),Object(i.b)("blockquote",null,Object(i.b)("h3",Object(a.a)({parentName:"blockquote"},{id:"note"}),"Note:"),Object(i.b)("p",{parentName:"blockquote"},"Technically speaking, this implementation most resembles ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"http://reasonmlhub.com/exploring-reasonml/ch_polymorphic-variants.html"}),Object(i.b)("strong",{parentName:"a"},"polymorphic variants")),". The implications of this will become clearer in the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"use/grouping"}),"grouping")," section. Users familiar with functional programming may be stroking neckbeards in consideration at this point.")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"The short version is this:")," A variant type is like an enum but each case can hold some extra data. Enums already help us express ideas in the domain as a set of symbols. Variants allow those symbols to include more specific information depending on each case. "),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Typically it's difficult to analyze code blocks. By holding to a pattern of matching against a variant (a.k.a. ",Object(i.b)("em",{parentName:"li"},"a set number of options"),") the compiler can help check your code flow for completeness, or ",Object(i.b)("em",{parentName:"li"},"exhaustiveness"),"."),Object(i.b)("li",{parentName:"ul"},"An underappreciated benefit is their ability to withstand refactoring. As an application grows in complexity a variant can simply add a new tag when branching functionality is needed. As a workflow needs more context the tag representing it can evolve from a simple symbol to a more complex type with its own constructor logic or async processing."),Object(i.b)("li",{parentName:"ul"},"This approach is a natural fit for describing a protocol where each message is a tag and the overall lexicon forms the variant type. A ",Object(i.b)("em",{parentName:"li"},"message handler")," is a single ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"/variant/docs/api#match"}),Object(i.b)("inlineCode",{parentName:"a"},"match()"))," statement. ",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"use/redux"}),"\ud83d\udc4b Hey there, redux")," .")))),Object(i.b)("h3",{id:"discriminated-unions-in-typescript"},"Discriminated Unions ",Object(i.b)("em",{parentName:"h3"},"in TypeScript")),Object(i.b)("p",null,"TypeScript can certainly handle discriminated unions without this library, but it's not a good solution. This is what it looks like at its best, and most people don't do it this way. They create the interface for the type and the function separately, resulting in even more duplication. Compare this vanilla TypeScript code to the animal example with variant. ",Object(i.b)("em",{parentName:"p"},"(Click the tabs to flip between the implementations).")),Object(i.b)(o.a,{groupId:"motivation-code-sample",defaultValue:"vanilla",values:[{value:"vanilla",label:"Vanilla TS"},{value:"variant",label:"Variant"}],mdxType:"Tabs"},Object(i.b)(c.a,{value:"vanilla",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript"}),"const DOG_TYPE = 'dog';\nconst CAT_TYPE = 'cat';\nconst SNAKE_TYPE = 'snake';\n\nfunction dog(name: string, favoriteBall?: string) {\n    return {\n        type: DOG_TYPE as typeof DOG_TYPE,\n        name,\n        favoriteBall,\n    }\n}\nconst cat = (name: string, furnitureDamaged: number) => ({\n    type: CAT_TYPE as typeof CAT_TYPE,\n    name,\n    furnitureDamaged,\n})\nconst snake = (name: string, patternName?: string) => ({\n    type: SNAKE_TYPE as typeof SNAKE_TYPE,\n    name,\n    pattern: patternName ?? 'striped',\n})\n\ntype Animal = \n    | ReturnType<typeof dog>\n    | ReturnType<typeof cat>\n    | ReturnType<typeof snake>;\n;\n"))),Object(i.b)(c.a,{value:"variant",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript"}),"export const Animal = variantModule({\n    dog: fields<{name: string, favoriteBall?: string}>(),\n    cat: fields<{name: string, furnitureDamaged: number}>(),\n    snake: (name: string, pattern = 'striped') => ({name, pattern}),\n});\nexport type Animal<T extends TypeNames<typeof Animal> = undefined>\n    = VariantOf<typeof Animal, T>;\n")))),Object(i.b)("hr",null),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Both methods result in the following union type:")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript"}),'type Animal = {\n    type: "dog";\n    name: string;\n    favoriteBall?: string | undefined;\n} | {\n    type: "cat";\n    name: string;\n    furnitureDamaged: number;\n} | {\n    type: "snake";\n    name: string;\n    pattern: string;\n}\n')),Object(i.b)("p",null,"But the variant approach is shorter, has better types, ",Object(i.b)("em",{parentName:"p"},"automatically updates")," as new animals are added, and requires ",Object(i.b)("strong",{parentName:"p"},"no manual casting"),"."))}m.isMDXComponent=!0},179:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),p=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},u=function(e){var t=p(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(n),b=a,d=u["".concat(o,".").concat(b)]||u[b]||m[b]||i;return n?r.a.createElement(d,c({ref:t},l,{components:n})):r.a.createElement(d,c({ref:t},l))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=b;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var l=2;l<i;l++)o[l]=n[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},180:function(e,t,n){var a;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var i=typeof a;if("string"===i||"number"===i)e.push(a);else if(Array.isArray(a)&&a.length){var o=r.apply(null,a);o&&e.push(o)}else if("object"===i)for(var c in a)n.call(a,c)&&a[c]&&e.push(c)}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(a=function(){return r}.apply(t,[]))||(e.exports=a)}()},186:function(e,t,n){"use strict";var a=n(0),r=Object(a.createContext)({tabGroupChoices:{},setTabGroupChoices:function(){}});t.a=r},193:function(e,t,n){"use strict";var a=n(0),r=n.n(a);t.a=function(e){return r.a.createElement("div",null,e.children)}},194:function(e,t,n){"use strict";n(25),n(19),n(20);var a=n(0),r=n.n(a),i=n(186);var o=function(){return Object(a.useContext)(i.a)},c=n(180),s=n.n(c),l=n(132),p=n.n(l),u=37,m=39;t.a=function(e){var t=e.block,n=e.children,i=e.defaultValue,c=e.values,l=e.groupId,b=o(),d=b.tabGroupChoices,f=b.setTabGroupChoices,h=Object(a.useState)(i),y=h[0],v=h[1];if(null!=l){var g=d[l];null!=g&&g!==y&&v(g)}var O=function(e){v(e),null!=l&&f(l,e)},j=[];return r.a.createElement("div",null,r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:s()("tabs",{"tabs--block":t})},c.map((function(e){var t=e.value,n=e.label;return r.a.createElement("li",{role:"tab",tabIndex:"0","aria-selected":y===t,className:s()("tab-item",p.a.tabItem,{"tab-item--active":y===t}),key:t,ref:function(e){return j.push(e)},onKeyDown:function(e){return function(e,t,n){switch(n.keyCode){case m:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case u:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(j,e.target,e)},onFocus:function(){return O(t)},onClick:function(){return O(t)}},n)}))),r.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},a.Children.toArray(n).filter((function(e){return e.props.value===y}))[0]))}}}]);